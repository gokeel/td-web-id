<?php

class Mailbox_m extends CI_Model {
	public function __construct() {
        parent::__construct();
		$this->load->library('Db_trans');
    }
	
	function get_mail_by_id($id){
		$this->db->select('*');
		$this->db->from('mailbox');
		$this->db->where('id', $id);
		
		$query = $this->db->get();
		
		return $this->db_trans->return_select_first_row($query);
	}

	function get_mail_data($user_id, $box){
		$this->db->select('*');
		$this->db->from('mailbox');
		if($box=="inbox"){
			$this->db->like('destination', $user_id);
			$this->db->where('status', 'Sent');
		}
		else if($box=="outbox"){
			$this->db->where('sender', $user_id);
			$this->db->where('status', 'Sent');
		}
		else if($box=="draft"){
			$this->db->where('sender', $user_id);
			$this->db->where('status', 'Draft');
		}
		else if($box=="trash"){
			$this->db->where('trashed_by', $user_id);
			$this->db->where('status', 'Trash');
		}
		$this->db->order_by('sent_timestamp desc');
		$query = $this->db->get();
		
		return $this->db_trans->return_select($query);
	}

	function get_outbox_data($user_id){
		$this->db->select('*');
		$this->db->from('mailbox');
		$this->db->order_by('sent_timestamp desc');
		$query = $this->db->get();
		
		return $this->db_trans->return_select($query);
	}

	function get_draft_data($user_id){
		$this->db->select('*');
		$this->db->from('mailbox');
		
		$this->db->order_by('sent_timestamp desc');
		$query = $this->db->get();
		
		return $this->db_trans->return_select($query);
	}
}